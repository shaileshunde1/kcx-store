{% extends "base.html" %}

{% block title %}Your Cart | KCX Crochet{% endblock %}

{% block content %}

<section class="py-5">
  <div class="container">
    <h2 class="fw-bold mb-4">Your Cart ðŸ§º</h2>

    {% if cart_items and cart_items|length > 0 %}
      <div class="row g-4">
        <!-- Cart items -->
        <div class="col-lg-8">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              {% for item in cart_items %}
                <div class="d-flex align-items-center mb-3 pb-3 border-bottom">
                  <!-- Image -->
                  <div style="width: 80px; height: 80px;" class="me-3 flex-shrink-0">
                    <img
                      src="{{ url_for('static', filename=item.product.image_url) }}"
                      alt="{{ item.product.name }}"
                      class="img-fluid rounded"
                      style="width: 100%; height: 100%; object-fit: cover;"
                    >
                  </div>

                  <!-- Info -->
                  <div class="flex-grow-1">
                    <h6 class="mb-1">{{ item.product.name }}</h6>
                    <p class="small text-muted mb-1">
                      {{ item.product.description[:60] }}{% if item.product.description and item.product.description|length > 60 %}...{% endif %}
                    </p>
                    <p class="mb-0 fw-semibold">â‚¹{{ item.product.price }}</p>
                  </div>

                  <!-- Quantity + line total -->
                  <div class="text-end" style="min-width: 120px;">
                    <div class="d-inline-flex align-items-center mb-1">
  <a href="{{ url_for('decrease_quantity', product_id=item.product.id) }}"
     class="btn btn-sm btn-outline-secondary">-</a>
  <span class="mx-2">{{ item.quantity }}</span>
  <a href="{{ url_for('increase_quantity', product_id=item.product.id) }}"
     class="btn btn-sm btn-outline-secondary">+</a>
</div>
<p class="mb-0 small text-muted">
  Line total: â‚¹{{ item.product.price * item.quantity }}
</p>
<a href="{{ url_for('remove_from_cart', product_id=item.product.id) }}"
   class="btn btn-link text-danger small p-0 mt-1">
  Remove
</a>

                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        </div>

        <!-- Summary -->
        <div class="col-lg-4">
          <div class="card border-0 shadow-sm">
            <div class="card-body">
              <h5 class="fw-bold mb-3">Order Summary</h5>

              <div class="d-flex justify-content-between mb-2">
                <span>Subtotal</span>
                <span>â‚¹{{ total }}</span>
              </div>

              <div class="d-flex justify-content-between mb-2">
                <span>Shipping</span>
                <span class="text-success">FREE</span>
              </div>

              <hr>

              <div class="d-flex justify-content-between mb-3 fw-bold">
                <span>Total</span>
                <span>â‚¹{{ total }}</span>
              </div>

              <button class="btn btn-dark w-100 mb-2" type="button">
                Proceed to Checkout
              </button>

              <a href="/shop" class="btn btn-outline-secondary w-100" type="button">
                Continue Shopping
              </a>

              <p class="small text-muted mt-3 mb-0">
                This is a demo cart UI. Next we will connect it with real "Add to Cart" logic and Razorpay.
              </p>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      <p>Your cart is empty.</p>
      <a href="/shop" class="btn btn-dark mt-2">Go to Shop</a>
    {% endif %}
  </div>
</section>

{% endblock %}
